<html xmlns:r="http://www.r-project.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Todo List: XMLSchema package</title>
<link rel="stylesheet" href="file:///Users/duncan/Classes/StatComputing/XDynDocs/inst/CSS/OmegaTech.css">
<link rel="stylesheet" href="file:///Users/duncan/Classes/StatComputing/XDynDocs/inst/CSS/Todo.css">
<script language="JavaScript" src="file:///Users/duncan/Classes/StatComputing/XDynDocs/inst/JavaScript/tooltips.js"></script>
</head>
<body>
<table><tr><th><a href="NewTodo.xsl"></a></th></tr></table>
<hr width="50%">
<center><table><tr valign="top">
<th align="left" style="padding-right: 130pt"><ol>
<li>
<a href="#Schema">Schema</a>
       - 32 <i class="notDone">(28)</i>
</li>
<li><a href="#Done">Done</a></li>
</ol></th>
<th align="right">
   Total number of elements: 32<br>
   Not yet completed: 28<br>
   High priority: 24<br>
   Completed: 4</th>
</tr></table></center>
<hr width="50%" height="2">
<div class="count-tables"><table><tr valign="top"><th><div border="1"><table border="0" frame="1"><tbody><tr><th class="table-count"><div class="table-count"><div class="topic-table">
<p align="center"><a href="#Schema">Schema</a></p>
<table width="200"><tbody>
<tr>
<th><i>Status</i></th>
<th><i>Count</i></th>
</tr>
<tr>
<td align="left" class="done"><a class="done" href="#Schema::done">done</a></td>
<td align="center" class="done">4</td>
</tr>
<tr>
<td align="left" class="check"><a class="check" href="#Schema::check">check</a></td>
<td align="center" class="check">4</td>
</tr>
<tr>
<td align="left" class="no-status"><a class="no-status" href="#Schema">no status</a></td>
<td align="center">24</td>
</tr>
<tr>
<th></th>
<th><hr width="50%"></th>
</tr>
<tr>
<th></th>
<td align="center">     (32)</td>
</tr>
</tbody></table>
</div></div></th></tr></tbody></table></div></th></tr></table></div>
<div><hr width="50%"></div>
<h2 class="topic"><a name=""></a></h2>
<ol><dl>
<hr width="50%" height="2">
<div class="done"></div>
</dl></ol>


<a href="NewTodo.xsl"></a>

<h2 class="topic"><a name="Schema">Schema</a></h2>
<div class="topic-table">
<p align="center"><a href="#"></a></p>
<table width="200"><tbody>
<tr>
<th><i>Status</i></th>
<th><i>Count</i></th>
</tr>
<tr>
<td align="left" class="done"><a class="done" href="#::done">done</a></td>
<td align="center" class="done">4</td>
</tr>
<tr>
<td align="left" class="check"><a class="check" href="#::check">check</a></td>
<td align="center" class="check">4</td>
</tr>
<tr>
<td align="left" class="no-status"><a class="no-status" href="#">no status</a></td>
<td align="center">24</td>
</tr>
<tr>
<th></th>
<th><hr width="50%"></th>
</tr>
<tr>
<th></th>
<td align="center">     (32)</td>
</tr>
</tbody></table>
</div>
<ol><dl>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
read the elementFormDefault attribute on the schema and store it on the SchemaTypes.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
restrictions. Extension element in pmml. Handle the attributes and the sequence in 

    &lt;xs:complexContent mixed="true"&gt;
      &lt;xs:restriction base="xs:anyType"&gt;
        &lt;xs:sequence&gt;
          &lt;xs:any processContents="skip" minOccurs="0" maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name="extender" type="xs:string" use="optional"/&gt;
        &lt;xs:attribute name="name" type="xs:string" use="optional"/&gt;
        &lt;xs:attribute name="value" type="xs:string" use="optional"/&gt;
      &lt;/xs:restriction&gt;
    &lt;/xs:complexContent&gt;

<pre class="rcode">
readSchema("inst/samples/pmml-4-0.xsd", createConverters = FALSE)
</pre>

</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
Avoid overwriting elements with the same name but different types,
i.e. an element and complexType.
See biblio.xsd in inst/samples.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
defClass() for SOAPComplexType
<br>
Probably should convert the SOAPComplexType into a  ClassDefinition
in processWSDL() rather than working with it in genSOAPClientInterface().
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
fromConverter for SOAPComplexType, and ArrayClassDefinition (actually for parent class CompositeTypeDefinition).
<br>
createSOAPConverter() method. 
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
cuahsi_1_0.asmx.wsdl has 

              &lt;s:element minOccurs="0" maxOccurs="1" name="timeZoneInfo"&gt;
                &lt;s:complexType&gt;
                  &lt;s:sequence&gt;
                    &lt;s:element minOccurs="1" maxOccurs="1" name="defaultTimeZone" nillable="true"&gt;
                      &lt;s:complexType&gt;
                        &lt;s:attribute name="ZoneAbbreviation" type="s:normalizedString"/&gt;
                        &lt;s:attribute name="ZoneOffset" type="s:string"/&gt;
                      &lt;/s:complexType&gt;
                    &lt;/s:element&gt;
                    &lt;s:element minOccurs="1" maxOccurs="1" name="daylightSavingsTimeZone" nillable="true"&gt;
                      &lt;s:complexType&gt;
                        &lt;s:attribute name="ZoneAbbreviation" type="s:normalizedString"/&gt;
                        &lt;s:attribute name="ZoneOffset" type="s:string"/&gt;
                      &lt;/s:complexType&gt;
                    &lt;/s:element&gt;
                  &lt;/s:sequence&gt;
                &lt;/s:complexType&gt;
              &lt;/s:element&gt;

in  &lt;s:complexType name="SiteInfoType"&gt;
and the sub-definitions come out as SOAPVoidType
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
substitutionGroup's
<br>
Include the hierarchy in the class hierarchy.
Or at least when defining 
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>

w = readSchema("../../SOAP/WSDLs/2007-01-19.ec2.wsdl")
Warning message:
In processSchemaType(el) :
  Failed to handle node EmptyElementType of type complexType &amp; text in processSchemaType. &lt;xs:complexType name="EmptyElementType"&gt;
		  &lt;/xs:complexType&gt;ProcessWSDLTypeError

</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
Handle the case where we have a simple element which has a reference to a type
and where do we put the attributes and definition of that type.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
When following references to a type definition in the schema,
we are stripping away namespace prefixes in the "new" code.
Check for this more carefully, i.e. do two searches - without
and with the namespace prefix.
<br>
See processSchemaType() and the two code segments for the conditions
  xmlName(type) == "element" &amp;&amp; !is.na(xmlGetAttr(type, "type", NA)) &amp;&amp; xmlSize(type) == 0 

and
 if(xmlName(type) == 'complexType' &amp;&amp; (xmlSize(type) == 1 &amp;&amp; names(type) == "attributeGroup"))  
<br>
Look for the 2 cases of gsub() in processSchemaType()
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
KML schema and the complexType element with name ObjectType
<pre class="rcode">
doc = xmlParse("~/Books/XMLTechnologies/Rpackages/RKML/inst/schema/kml21.xsd")
o = getNodeSet(doc, "//x:*[@name='ObjectType']", "x")
processSchemaType(o[[1]])
</pre>
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
When we have a sequence  with only one element which has a count
of c(minOccurs = 1,  maxOccurs = 1), then we return the element type.
But we have to make certain that in the conversion from XML node to
R object, we also unpeel the outer node.
See msn search example.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
Infinite recursion:
<pre class="rcode">
msn = processWSDL("http://soap.search.msn.com/webservices.asmx?wsdl")
trace(resolve, quote(cat(class(obj), if(is.character(obj)) obj, "\n")))
zz = resolve(msn@operations[[1]][[1]]@returnValue, msn@types)
</pre>
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
fromConverter for msn search example 
has 
<pre class="rcode">
function(x, ..., obj = new( 'Search' )) {
function (fun = sys.function(sys.parent())) 
obj
}
</pre>
<pre class="rcode">
msn = processWSDL("http://soap.search.msn.com/webservices.asmx?wsdl")
i.msn = genSOAPClientInterface(,msn)
resolve(msn@operations[[1]][[1]]@parameters[[1]], msn@types, recursive = FALSE)
</pre>
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
Skipping attributes of complexType (e.g. Aggregate in PMML schema)
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
UnionDefinition  having NULL for slotType.
e.g. pmml-3-2.xsd.
What if we have a ref and not a type in the 
child of a xs:choice node.

EXPRESSION, PREDICATE, Rule
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
UnionDef() call. 
Need to deal with local element definitions and references  to other 
existing global elements.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
complexType/simpleContent with extensions to a string
ending up as a ClassDefinition.
<br>
PMML MatCell
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
createSOAPConverter for SimpleElement.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
readSchema("~/eBaySvc.wsdl", useInternal = T) is failing.
<br>
As it should. That is a WSDL, not a schema. Perhaps we should make
it smart enough to understand this.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
For elements with mixed="true", record this and make use of it.
e.g. ArrayType in PMML.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
See if an attribute element is allowed to have any
children other than a simpleType/restriction path?
If not, then merge the two cases for attribute in
processWSDLType into a single processing.
<br>
I think this is true.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
MSN search schema in  the WSDL.
Problem with UTF when we download it and reformat it in R.
<pre class="rcode">
v = readSchema("WSDLs/msnSearch.asmx")
</pre>
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class=""><li class="" title="">
<a name="::"></a>
SourceType and SafeSearchOptions coming out as 
ExtendedClassDefinition.
Same.
</li></dt>
<dd class=""></dd>
</div>
<div class="todoItem">
<dt class="check"><li class="check" title="check">
<a name="::check"></a>
For sequences, or for any element actually, add the constraints
on the counts, e.g. c(0, Inf) or c(1, 3) or c(1).
</li></dt>
<dd class="check"></dd>
</div>
<div class="todoItem">
<dt class="check"><li class="check" title="check">
<a name="::check"></a>
Method for createSOAPConverter() for UnionDefinition 
and also for SimpleSequenceType and SimpleElement.
<br>
See PMML schema (pmml-3-2.xsd) for 3 examples of UnionDefinition
and the xsd files in WSDLs for the SimpleSequenceType.
e.g. IdListType, FieldListType, LinkListType, ...
TypeTranslationSetType.
</li></dt>
<dd class="check"></dd>
</div>
<div class="todoItem">
<dt class="check"><li class="check" title="check">
<a name="::check"></a>
MSN  schema. First element

      &lt;xsd:simpleType name="SourceType"&gt;
        &lt;xsd:restriction base="xsd:string"&gt;
          &lt;xsd:enumeration value="Web"/&gt;
          &lt;xsd:enumeration value="News"/&gt;
          &lt;xsd:enumeration value="Ads"/&gt;
          &lt;xsd:enumeration value="InlineAnswers"/&gt;
          &lt;xsd:enumeration value="PhoneBook"/&gt;
          &lt;xsd:enumeration value="WordBreaker"/&gt;

is coming out as an ExtendedClassDefinition rather
than an enumeration.
</li></dt>
<dd class="check"></dd>
</div>
<div class="todoItem">
<dt class="check"><li class="check" title="check">
<a name="::check"></a>
MSN search schema and second element xsl:ist
These are all the same and
causing the same problems as they come out as  simple
character values when processed by the schema. 
ResultFieldMask     SearchFlags      SortByType 
<br>
These three problems are now implemented with
RestrictedListType and EnumValuesDef in processSchemaType.
Check that they behave completely.
</li></dt>
<dd class="check"></dd>
</div>
<hr width="50%" height="2">
<div class="done">
<div class="todoItem"><dt class="done"><li class="done" title="done">
<a name="::done"></a>
Where does ObjectType go in readSchema() for KML.
</li></dt></div>
<div class="todoItem"><dt class="done"><li class="done" title="done">
<a name="::done"></a>
The class Element should have a fromConverter and the function should be generated.
Should this be a SOAPType.
<br>
Element extends SchemaElement and that extends BasicSOAPType
</li></dt></div>
<div class="todoItem"><dt class="done"><li class="done" title="done">
<a name="::done"></a>
Some elements in the eBaySvc schema are just simply lists
and not SOAPType classes
<pre class="rcode">
which(sapply(types[[1]], class) == "list")
           ErrorParameterType              AttributeSetType                 AttributeType               CharityInfoType 
                          553                           597                           598                           679 
           DataElementSetType            HistogramEntryType                     LabelType ListingDurationDefinitionType 
                          720                           797                           832                           838 
            ProductFamilyType               ProductInfoType                   ProductType          ReasonCodeDetailType 
                          998                          1000                          1008                          1030 
</pre>
These seem to be complexType/{annotation, sequence, attribute}.
What should these be. They are complexType's  with a name and attribute
and content. 
<br>
<pre class="rcode">
doc = xmlParse("~/eBaySvc.wsdl")
x = processWSDLTypes(doc[["//wsdl:types", namepace = "ws"]], createConverters = FALSE, verbose = TRUE)
</pre>
</li></dt></div>
<div class="todoItem"><dt class="done"><li class="done" title="done">
<a name="::done"></a>
processWSDLTypes and different unhandled cases.
3 in PMML schema.
"SelectResult" element definition with child
 complexType with just attributes - field, feature, value
"ParameterField" and  differently(?)   "ArrayType"
<br>
Converted these to SimpleElement.
</li></dt></div>
</div>
</dl></ol>
</body>
</html>
